{
  "comments": [
    {
      "key": {
        "uuid": "9ad9bd40_bc5fd871",
        "filename": "logs/cloudfiles-segmenter-asm/src/main/java/org/openstack/atlas/cloudfiles/itest/CloudFilesCli.java",
        "patchSetId": 3
      },
      "lineNbr": 93,
      "author": {
        "id": 1001830
      },
      "writtenOn": "2015-06-30T04:57:45Z",
      "side": 1,
      "message": "I see that the default is defined in another file in the case this is null -- I feel like it\u0027d make more sense and be slightly clearer if the default was the else-clause here, but it\u0027s not a deal breaker.",
      "revId": "f68b336b963689adf24a14f8ae0d56db01ce5562",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_911d9a76",
        "filename": "logs/cloudfiles-segmenter-asm/src/main/java/org/openstack/atlas/cloudfiles/itest/CloudFilesCli.java",
        "patchSetId": 3
      },
      "lineNbr": 93,
      "author": {
        "id": 1001794
      },
      "writtenOn": "2015-06-30T20:03:55Z",
      "side": 1,
      "message": "Your thinking of the resetConfig() function which reads from /etc/openstack/blah.conf which is what production uses.\n\nFor the command line we allow the user to overwrite the defaults and load them from a jason file in the home directory of that user. This allows us to test the CloudFiles stuff from differen\u0027t accounts. In short you don\u0027t have to use the loadJsonConf if your ok with using the defaults defined in /etc/openstack/atlas.\n\nBy the way the CLI code never makes it to production. It will need to be assembled and ran via \"java -jar\" from the command line.",
      "parentUuid": "9ad9bd40_bc5fd871",
      "revId": "f68b336b963689adf24a14f8ae0d56db01ce5562",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_1465f8e0",
        "filename": "logs/cloudfiles-segmenter-asm/src/main/java/org/openstack/atlas/cloudfiles/itest/CloudFilesCli.java",
        "patchSetId": 3
      },
      "lineNbr": 93,
      "author": {
        "id": 1001830
      },
      "writtenOn": "2015-06-30T20:36:39Z",
      "side": 1,
      "message": "I don\u0027t think so? The issue I saw here was what happens if the user runs \"loadJsonConf\" without a second arg, would filePath end up null? Answer: yes, but in CloudFilesConfig.readJsonConfigs(filePath) it does a null-check and sets a default. That\u0027s what I was referring to about the default being specified elsewhere.",
      "parentUuid": "9ad9bd40_911d9a76",
      "revId": "f68b336b963689adf24a14f8ae0d56db01ce5562",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_74d00454",
        "filename": "logs/cloudfiles-segmenter-asm/src/main/java/org/openstack/atlas/cloudfiles/itest/CloudFilesCli.java",
        "patchSetId": 3
      },
      "lineNbr": 93,
      "author": {
        "id": 1001794
      },
      "writtenOn": "2015-06-30T21:08:35Z",
      "side": 1,
      "message": "val \u003d default\nif(userSpecified){\n   val \u003d userSpecified\n}\n\nis a pretty common pattern for setting defaults.\n\nI\u0027m suspect this became popular due to it emitting a lower cyclomatic score.",
      "parentUuid": "9ad9bd40_bc5fd871",
      "revId": "f68b336b963689adf24a14f8ae0d56db01ce5562",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_54b6a03e",
        "filename": "logs/cloudfiles-segmenter-asm/src/main/java/org/openstack/atlas/cloudfiles/itest/CloudFilesCli.java",
        "patchSetId": 3
      },
      "lineNbr": 93,
      "author": {
        "id": 1001794
      },
      "writtenOn": "2015-06-30T21:08:35Z",
      "side": 1,
      "message": "yes the readJsonConf will default to cloudFiles.json if null is passed in. Trouble is arg[1] will throw array out of bounds exception if the user does not type a file path. so the check uses either filePath \u003d arg[1] if arg goes up to [1] or null if arg[1] does not exist.",
      "parentUuid": "9ad9bd40_1465f8e0",
      "revId": "f68b336b963689adf24a14f8ae0d56db01ce5562",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_dc53bc6a",
        "filename": "logs/cloudfiles-segmenter/src/main/java/org/openstack/atlas/cloudfiles/CloudFilesConfig.java",
        "patchSetId": 3
      },
      "lineNbr": 74,
      "author": {
        "id": 1001830
      },
      "writtenOn": "2015-06-30T04:57:45Z",
      "side": 1,
      "message": "Does this cast work properly? I wonder if using Integer.parseInt() from string form would be safer? I guess if you\u0027ve tested it and it works, then this is fine.",
      "revId": "f68b336b963689adf24a14f8ae0d56db01ce5562",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_d40e3034",
        "filename": "logs/cloudfiles-segmenter/src/main/java/org/openstack/atlas/cloudfiles/CloudFilesConfig.java",
        "patchSetId": 3
      },
      "lineNbr": 74,
      "author": {
        "id": 1001794
      },
      "writtenOn": "2015-06-30T20:03:55Z",
      "side": 1,
      "message": "For some reason google json will actually returns a Long and never an Integer when it sees a number.\n IE if you put 1 it still returns a Long. intValue() will just return the lower 32 bits as an Integer. I would have liked to keep it as a long but when I use this to set the number of bytes to send in an HTTP request I can only use a 32 bit value so 2147483647 is the max it will allow. So I just store it as an int anyways.\n\nin general the get() function in the jsonParser returns an Object reference. When you do a (Long)or any kind of cast in source code your really just doing a \"checkcast\" in the JVM bytecode and telling the compiler that from that point on you want to reference the Long instance methods on that \"Object\" in subsequent calls. The byte code for the line in question is?\n\n   75:\tldc\t#50; //String cloud_files_lzo_segment_size\n   77:\tinvokevirtual\t#47; //Method org/json/simple/JSONObject.get:(Ljava/lang/Object;)Ljava/lang/Object;\n   80:\tcheckcast\t#51; //class java/lang/Long\n   83:\tinvokevirtual\t#52; //Method java/lang/Long.intValue:()I\n   86:\tputstatic\t#17; //Field segmentSize:I\n\nI used to find that odd myself for a while. TypeCasting in java really isn\u0027t converting a type. Its just telling the compiler to use Class code for Long.methods() on this \"Object\" if it survives the checkcast(long) test. Checkcast just verifies that the physical imple for Object in inherted from Long or is a Long reference.",
      "parentUuid": "9ad9bd40_dc53bc6a",
      "revId": "f68b336b963689adf24a14f8ae0d56db01ce5562",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_3462fcd8",
        "filename": "logs/cloudfiles-segmenter/src/main/java/org/openstack/atlas/cloudfiles/CloudFilesConfig.java",
        "patchSetId": 3
      },
      "lineNbr": 74,
      "author": {
        "id": 1001830
      },
      "writtenOn": "2015-06-30T20:36:39Z",
      "side": 1,
      "message": "Yeah, my concern was that the Long cast happens on the result of rootConf.get(), before .intValue() is run. I thought rootConf.get() returned a String, and (Long)String doesn\u0027t work. I guess rootConf.get() is smart and returns an Int or Long already?",
      "parentUuid": "9ad9bd40_d40e3034",
      "revId": "f68b336b963689adf24a14f8ae0d56db01ce5562",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_54bb000e",
        "filename": "logs/cloudfiles-segmenter/src/main/java/org/openstack/atlas/cloudfiles/CloudFilesConfig.java",
        "patchSetId": 3
      },
      "lineNbr": 74,
      "author": {
        "id": 1001794
      },
      "writtenOn": "2015-06-30T21:08:35Z",
      "side": 1,
      "message": "the get() method returns a Object but in the debugger you can see that its Object with a reference to a Long instance.\n\nyour probably more used to seeing code like\n\nObject obj \u003d rootConf.get()\nif(obj instanceof String){\n    (String)obj.call_some_string_methods()\n}else if(obj instance Long){\n    (Long)obj.call_some_long_methods()\n}\n\nyea I see the confusion. The (Long) cast isn\u0027t triggering a parse string its assuming the return type of rootConf.get() is a Long inst.\n\nI\u0027m guessing its definition is of the form\n\npublic Object get(String key){\n    String val \u003d fetchStringFromJson(key)\n    if(canBeParsedToLong(val){\n        return new Long(parseLongFromString(val);\n    }else{\n        return new String(val);\n    }\n\nthey both get returned as an Object. But that object is pointing to either a String or Long in the JVM heap.",
      "parentUuid": "9ad9bd40_3462fcd8",
      "revId": "f68b336b963689adf24a14f8ae0d56db01ce5562",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9ad9bd40_b4260c67",
        "filename": "logs/cloudfiles-segmenter/src/main/java/org/openstack/atlas/cloudfiles/CloudFilesConfig.java",
        "patchSetId": 3
      },
      "lineNbr": 74,
      "author": {
        "id": 1001830
      },
      "writtenOn": "2015-06-30T21:13:04Z",
      "side": 1,
      "message": "Yeah that makes sense.",
      "parentUuid": "9ad9bd40_54bb000e",
      "revId": "f68b336b963689adf24a14f8ae0d56db01ce5562",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    }
  ]
}